;
; Declare all imported modules and their data/functions.
;
import stdlib
  predef cls, gotoxy, viewport, puts, putc, getc
end

import testlib
  predef puti, putnl
end
const mainentry = 2
;
; Predeclare any functions called before defined.
;
predef ascii, main
;
; Declare all global variables for this module.
;
byte hello[] = "Hello, world.\n"
word defptr  = @ascii, @main
word struct[] = 1, 10, 100
;
; Define functions.
;
def ascii
  byte i
  for i = 32 to 127
    putc(i)
  next
end

def nums(range)
  word i
  for i = -10 to range
    puti(i)
    putnl
  next
end

export def main(range)
  cls
  nums(range)
  viewport(12, 12, 16, 8)
  ascii
  viewport(0, 0, 40, 24)
  gotoxy(15,5)
  puts(@hello)
end

export def indirect
  word mainptr
  mainptr = @main
  return defptr:mainentry(struct:2)
end

indirect
done
