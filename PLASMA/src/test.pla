;
; Declare all imported modules and their data/functions.
;
import stdlib
  predef cls, gotoxy, viewport, puts, putc, getc
end

import testlib
  predef puti, putnl
end
;
; Predeclare any functions called before defined.
;
predef main
;
; Declare all global variables for this module.
;
byte hello[] = "Hello, world.\n"
word defptr  = main
;
; Define functions.
;
def ascii
  byte i
  for i = 32 to 127
    putc(i)
  next
end

def nums
  word i
  for i = -10 to 10
    puti(i)
    putnl
  next
end

export def main
  cls
  nums
  viewport(12, 12, 16, 8)
  ascii
  viewport(0, 0, 40, 24)
  gotoxy(15,5)
  puts(@hello)
end

export def indirect
  word mainptr
  mainptr = @main
  *mainptr()
end

indirect
done
